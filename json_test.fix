module Main;

import UnitTest;
import Json;
import HashMap;

test_encode_ok: (Json, String) -> TestCase;
test_encode_ok = |(json, expected)| (
    let testname = "test_encode_ok";
    make_test(testname) $
    let actual = json.encode;
    let _ = *(lift $ println (actual));
    pure()
);

main: IO ();
main = (
    let obj = [("aaa", number(1.2)), ("bbb", string("hoge"))].to_object;
    let obj2 = [("aaa", obj), ("bbb", obj)].to_object;
    [
        test_encode_ok $ (string("ab\"\\cd"), "xxx"),
        test_encode_ok $ (array([number(1.2), string("hoge")]), "xxx"),
        test_encode_ok $ (obj, "xxx"),
        test_encode_ok $ (obj2, "xxx")
    ]
    .run_test_driver
);