module Minilib.Data.Monoid.First;

import Minilib.Trait.Monoid;

type First a = unbox struct {
    data: Option a
};

to_first: Option a -> First a;
to_first = |opt| First { data: opt };

get_first: First a -> Option a;
get_first = @data;

impl First a: Monoid {
    mempty = to_first(none());
    mappend = |b, a| (
        if a.@data.is_some { a } else { b }
    );
}
