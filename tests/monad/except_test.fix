module Main;

import Debug;

import Minilib.Monad.Except;
import Minilib.Monad.Trans;
import Minilib.Monad.Error;
import Minilib.Text.StringEx;
import Minilib.Testing.UnitTest;

test_except_functor: TestCase;
test_except_functor = (
    make_test("test_except_functor") $ |_|
    let ema: ExceptT ErrMsg IO I64 = except_t $ pure $ ok(2);
    let ema = ema.map(add(1));
    let ema = ema.map(to_string);
    assert_equal("eq", ok $ "3", *ema.run_except_t.lift)
);

main: IO ();
main = (
    [
        test_except_functor,
    ]
    .run_test_driver
);

