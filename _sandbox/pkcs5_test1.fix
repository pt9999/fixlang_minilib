// RFC 8018 - PKCS #5: Password-Based Cryptography Specification Version 2.1 
//
// https://datatracker.ietf.org/doc/html/rfc8018
//
// Japanese translation:
// https://tex2e.github.io/rfc-translater/html/rfc8018.html
module Main;

import Debug;

import Minilib.Crypto.HMAC;
import Minilib.Text.Hex;

type PBKDF2 = unbox struct {
    prf: HMAC
};

namespace PBKDF2 {
    make: HMAC -> PBKDF2;
    make = |hmac| (
        PBKDF2 { prf: hmac }
    );

    exec: Array U8 -> Array U8 -> I64 -> I64 -> PBKDF2 -> Result ErrMsg (Array U8);
    exec = |password, salt, iter_count, derived_key_len, pbkdf2| (
        let hlen = pbkdf2.@prf.@output_block_size;
        if derived_key_len > 0x7FFFFFFF * hlen {
            err $ 
        
    );
}

/*
type PBES2 = unbox struct {
};
*/

main: IO ();
main = (
    pure()
);
