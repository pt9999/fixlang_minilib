module Main;

import Debug;

import Minilib.Crypto.Tls13.Types;
import Minilib.Crypto.Tls13.Secret;
import Minilib.Crypto.Tls13.CipherSuite;
import Minilib.Encoding.Binary;
import Minilib.Text.Hex;
import Minilib.Text.StringEx;
import Minilib.Testing.UnitTest;


test_early_secret: TestCase;
test_early_secret = (
    make_test("test_early_secret") $ |_|
    let cipher_suite: CipherSuite = _TLS_AES_128_GCM_SHA256();
    let hkdf = *HKDF::from_cipher_suite(cipher_suite).from_result;
    let secret = *hkdf.derive_early_secret_0.from_result;
    eval *println(secret.to_string_hex).lift;
    pure()
);

main: IO ();
main = (
    [
        test_early_secret
    ]
    .run_test_driver
);
