module Main;

import Minilib.Trait.Eq1;
import Minilib.Testing.UnitTest;

test_array_eq1: TestCase;
test_array_eq1 = (
    make_test("test_array_eq1") $ |_|
    assert_true("eq1", [1].eq1([1]));;
    assert_true("eq1", ! [1].eq1([]))
);

test_option_eq1: TestCase;
test_option_eq1 = (
    make_test("test_option_eq1") $ |_|
    assert_true("eq1", some(1).eq1(some(1)));;
    assert_true("eq1", ! some(1).eq1(none()))
);

test_result_eq1: TestCase;
test_result_eq1 = (
    make_test("test_result_eq1") $ |_|
    assert_true("eq1", ok(1).eq1(ok(1): Result ErrMsg I64));;
    assert_true("eq1", ! ok(1).eq1(err("e")))
);

test_tuple2_eq1: TestCase;
test_tuple2_eq1 = (
    make_test("test_tuple2_eq1") $ |_|
    assert_true("eq1", ("a", 1).eq1(("a",1)));;
    assert_true("eq1", ! ("a", 1).eq1(("b", 1)))
);

test_identity_eq1: TestCase;
test_identity_eq1 = (
    make_test("test_identity_eq1") $ |_|
    assert_true("eq1", Identity{ data: 1}.eq1(Identity{ data: 1}));;
    assert_true("eq1", ! Identity{ data: 1}.eq1(Identity{ data: 2}))
);

test_const_eq1: TestCase;
test_const_eq1 = (
    make_test("test_const_eq1") $ |_|
    assert_true("eq1", Const{ data: 1}.eq1(Const{ data: 1}: Const I64 String));;
    assert_true("eq1", ! Const{ data: 1}.eq1(Const{ data: 2}: Const I64 String))
);

main: IO ();
main = (
    [
        test_array_eq1,
        test_option_eq1,
        test_result_eq1,
        test_tuple2_eq1,
        test_identity_eq1,
        test_const_eq1,
    ]
    .run_test_driver
);
