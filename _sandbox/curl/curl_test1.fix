module Main;

import Minilib.Net.Curl;
import Minilib.Text.StringEx;

main : IO ();
main = (
    eval *println("program start");
    do {
        let curl = *Curl::make;
        eval *curl.set_url("http://www.google.co.jp/");
        eval *curl.set_write_callback(|bytes|
            eval *println(">> bytes.size=" + bytes.get_size.to_string).lift;
            pure $ bytes.get_size
        );
        eval *curl.perform;
        pure()
    }
    .try (|err| eprintln (err))
);
