module Minilib.Data.Monoid.First;

import Minilib.Trait.Monoid;

type First a = unbox struct {
    data: Option a
};

from_option: Option a -> First a;
from_option = |opt| First { data: opt };

get_first: First a -> Option a;
get_first = @data;

impl First a: Monoid {
    mempty = from_option(none());
    mconcat = |b, a| (
        if a.@data.is_some { a } else { b }
    );
}
