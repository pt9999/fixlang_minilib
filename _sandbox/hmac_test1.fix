module Main;

import Debug;

import Minilib.Crypto.HMAC;
//import Minilib.Encoding.Binary;
import Minilib.Text.Hex;

// RFC2104 Appendix Test Vector
test1: IO ();
test1 = (
    [
        (Array::fill(16, 0x0b_U8), "Hi There".get_bytes.pop_back),
        ("Jefe".get_bytes.pop_back, "what do ya want for nothing?".get_bytes.pop_back),
        (Array::fill(16, 0xaa_U8), Array::fill(50, 0xdd_U8))
    ]
    .to_iter.fold_m(
        (), |_, (key, data)|
        let digest = hmac_md5.digest(key, data);
        println(digest.to_string_hex)
    )
);

main: IO ();
main = test1;

