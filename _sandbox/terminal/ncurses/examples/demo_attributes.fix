module Main;

import Minilib.Common.IteratorEx;
import Minilib.Terminal.Ncurses;
import Minilib.Trait.Traversable;
import Minilib.Text.StringEx;
import Minilib.Text.Unicode;
import Minilib.Text.WideChar;
import Minilib.Trait.Traversable;

test1: IO ();
test1 = do {
    Ncurses::run $ |win| (
        win.clear;;
        let (w, h) = *win.get_window_size;
        let attrs = [
            ("normal", Attr::normal),
            ("standout", Attr::standout),
            ("underline", Attr::underline),
            ("reverse", Attr::reverse),
            ("blink", Attr::blink),
            ("dim", Attr::dim),
            ("bold", Attr::bold),
            ("altcs", Attr::alt_charset),
            ("invis", Attr::invis),
            ("protect", Attr::protect),
        ];
        range(0, attrs.get_size).foreach_m(|i|
            range(0, 8).foreach_m(|j|
                let cp: ColorPair = j;
                win.set_color_pair(cp, attrs.@(i).@1);;
                win.move_add_str(j * 10, i, attrs.@(i).@0);;
                pure()
            )
        );;
        win.set_color_pair(cp_white, Attr::normal);;
        win.move_add_wstr(0, attrs.get_size + 1, "<<< 終了するには何かキーを押してください >>>");;
        let key = *win.get_key;
        pure()
    )
}.try(eprintln);


main: IO ();
main = test1;
