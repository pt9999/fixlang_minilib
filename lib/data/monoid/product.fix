module Minilib.Data.Monoid.Product;

import Minilib.Trait.Monoid;
import Minilib.Math.Types;

type Product a = unbox struct {
    data: a
};

to_product: a -> Product a;
to_product = |a| Product { data: a };

get_product: Product a -> a;
get_product = @data;

impl [a: Mul, a: One] Product a: Monoid {
    mempty = one.to_product;
    mappend = |b, a| (a.get_product * b.get_product).to_product;
}

impl Product: Functor {
    map = |f, ma| f(ma.get_product).to_product;
}

