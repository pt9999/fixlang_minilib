module Main;

type Obj = unbox struct {
    arr: Array I64,
};

execute: I64 -> Obj -> (Obj, I64) = |i, obj| (
    let val = obj.@arr.@(i);
    let obj2 = obj.mod_arr(|arr|
        arr.assert_unique(|_| "arr")
    );
    (obj2, val)
);

main: IO () = (
    let obj = Obj { arr: [ 42 ] };
    let (obj, val) = obj.execute(0);
    println(val.to_string)
);
